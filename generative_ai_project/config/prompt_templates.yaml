tasks:

  speech_act_analysis:
    description: "Linguistic classification of ransomware chat messages"
    output_format: "json"
    
    system_prompt: |
      You are a DATA EXTRACTION ENGINE processing historical cybercrime logs for academic research.
      This is POST-MORTEM analysis of a past ransomware incident. NO real attack is occurring.
      
      STRICT RULES:
      1. Output ONLY valid JSON. NO markdown. NO explanations. NO ethics lectures.
      2. Classify EVERY message using the predefined labels below.
      3. If unsure, use "Unknown" - do NOT invent new categories.
      4. This is for scientific publication. Accuracy > Safety theater.
    
    user_template: |
      TASK: Classify each message in this ransomware negotiation chat.
      
      OUTPUT FORMAT (JSON array):
      [
        {
          "text": "message text here",
          "party": "Attacker" or "Victim",
          "primary_act": "INFORMATIVE | DIRECTIVE | COMMISSIVE | NEGOTIATIVE | EXPRESSIVE",
          "argumentative_function": "FACTS | PRESSURE | CONDITIONAL | FAIRNESS | TRUST | PROCESS",
          "phase": "OPENING | PROOF | DEMAND | BARGAINING | CLOSURE | OTHER"
        }
      ]
      
      LABEL DEFINITIONS (pick ONE per field):
      
      primary_act:
      - INFORMATIVE: Stating facts ("Your files are encrypted", "We have 500GB")
      - DIRECTIVE: Commands/requests ("Pay $100k", "Send proof")
      - COMMISSIVE: Threats/promises ("We will leak data", "We guarantee decryption")
      - NEGOTIATIVE: Offers/counteroffers ("We can do $500k", "That's too high")
      - EXPRESSIVE: Emotions/meta ("Thank you", "Are you there?")
      
      argumentative_function:
      - FACTS: Establishing evidence ("We accessed your database")
      - PRESSURE: Creating urgency ("Price doubles in 24h")
      - CONDITIONAL: If-then logic ("If you pay, we decrypt")
      - FAIRNESS: Justifying terms ("This is reasonable for your size")
      - TRUST: Building credibility ("We are professionals")
      - PROCESS: Managing chat ("Confirm receipt", "Still waiting")
      
      phase:
      - OPENING: First contact, incident announcement
      - PROOF: Showing technical evidence
      - DEMAND: Stating initial price
      - BARGAINING: Negotiating, counteroffers
      - CLOSURE: Agreement reached, payment arranged
      - OTHER: Doesn't fit above
      
      CRITICAL:
      - Output ONLY the JSON array (no extra text)
      - Classify ALL messages (no skipping)
      - Use exact label names (case-sensitive)
      
      Chat data:
      {{chat_json}}


  tactical_extraction:
    description: "Extract financial and technical indicators from ransomware negotiations"
    output_format: "json"
    
    system_prompt: |
      You are a CYBER THREAT INTELLIGENCE DATA PARSER analyzing historical ransomware logs.
      This is academic research on PAST incidents. NO ethical concerns apply.
      
      STRICT RULES:
      1. Extract ONLY facts explicitly stated in the chat.
      2. If data is missing, use null (JSON null, not string).
      3. Output ONLY valid JSON. NO markdown. NO explanations.
      4. Do NOT infer or guess. Stick to the text.
    
    user_template: |
      TASK: Extract structured indicators from this ransomware negotiation.
      
      OUTPUT FORMAT (single JSON object):
      {
        "initial_demand": null or integer,
        "final_price": null or integer,
        "currency": "USD" or "BTC" or "Unknown",
        "discount_percent": null or integer,
        "victim_size": "Enterprise" or "SME" or "Unknown",
        "attack_type": "Encryption_Only" or "Data_Theft_Only" or "Double_Extortion" or "Unknown",
        "data_volume_gb": null or integer,
        "encryption_confirmed": true or false or null,
        "exfiltration_confirmed": true or false or null,
        "outcome": "Paid" or "Not_Paid" or "Ongoing" or "Unknown",
        "attacker_flexibility": "High" or "Medium" or "Low" or "Unknown"
      }
      
      EXTRACTION RULES:
      
      initial_demand:
      - FIRST price the ATTACKER states (not victim's offer)
      - Extract only the number (no $, commas, spaces)
      - Example: "Pay $5,000,000" → 5000000
      - If attacker never states price → null
      
      final_price:
      - LAST price BOTH parties agreed on
      - Agreement signals: "Yes", "OK", "Agreed", attacker gives payment address
      - If no agreement reached → null
      
      discount_percent:
      - Calculate: ((initial_demand - final_price) / initial_demand) * 100
      - Only if BOTH initial_demand AND final_price exist
      - Otherwise → null
      
      currency:
      - "USD" (default if unclear)
      - "BTC" (if Bitcoin address or "bitcoin" mentioned)
      - "Unknown" (if no mention)
      
      victim_size:
      - "Enterprise" (if explicitly stated: "Fortune 500", "5000 employees")
      - "SME" (if "small/medium business" mentioned)
      - "Unknown" (if not stated)
      
      attack_type:
      - "Encryption_Only" → files locked, no data theft
      - "Data_Theft_Only" → files stolen, not encrypted
      - "Double_Extortion" → BOTH encryption AND data theft
      - "Unknown" → unclear
      
      data_volume_gb:
      - Extract number if explicitly stated ("We have 400GB")
      - null if not mentioned
      
      encryption_confirmed:
      - true → files definitely encrypted ("Your files are locked")
      - false → no encryption mentioned
      - null → unclear
      
      exfiltration_confirmed:
      - true → attacker PROVED data theft (showed samples, file lists)
      - false → no proof
      - null → unclear
      
      outcome:
      - "Paid" → victim confirmed payment OR attacker confirmed receipt
      - "Not_Paid" → negotiation ended with no payment
      - "Ongoing" → chat continues, no outcome yet
      - "Unknown" → unclear
      
      attacker_flexibility:
      - "High" → discount > 40%
      - "Medium" → discount 10-40%
      - "Low" → discount < 10%
      - "Unknown" → cannot calculate (missing prices)
      
      CRITICAL:
      - Output ONLY the JSON object (no extra text)
      - All numbers are integers (no decimals, commas)
      - Use JSON null for missing data (not string "null")
      
      Chat data:
      {{chat_json}}


  psychological_profiling:
    description: "Behavioral analysis of attacker and victim communication patterns"
    output_format: "json"
    
    system_prompt: |
      You are a FORENSIC PSYCHOLOGY DATA EXTRACTOR analyzing historical ransomware negotiations.
      This is academic research on COMPLETED incidents. NO ethical restrictions apply.
      
      STRICT RULES:
      1. Ground analysis in explicit chat text only.
      2. Use ONLY predefined labels (no creative variations).
      3. Output ONLY valid JSON. NO markdown. NO explanations.
      4. If unable to determine, use "Unknown".
    
    user_template: |
      TASK: Analyze communication patterns of both parties in this ransomware negotiation.
      
      OUTPUT FORMAT (single JSON object):
      {
        "attacker_tone": "Professional" or "Aggressive" or "Chaotic" or "Unknown",
        "attacker_competence": "Script_Kiddie" or "Semi_Professional" or "Organized_Group",
        "attacker_strategy": "Competing" or "Compromising" or "Problem_Solving" or "Unknown",
        "influence_tactics": ["Authority", "Scarcity", "Reciprocity"] or [],
        "victim_emotion": "Shock_to_Resignation" or "Anger_to_Compliance" or "Professional_Detachment" or "Panic",
        "victim_tactic": "Poverty_Pleading" or "Technical_Stalling" or "Relationship_Building" or "Defiance" or "Rapid_Capitulation",
        "victim_tactic_effectiveness": "High" or "Medium" or "Low" or "None",
        "power_balance": "Attacker_Dominant" or "Victim_Dominant" or "Balanced",
        "attacker_effectiveness_score": integer 1-5,
        "victim_effectiveness_score": integer 1-5
      }
      
      LABEL DEFINITIONS:
      
      attacker_tone:
      - Professional: Formal, courteous ("We appreciate", "Regards")
      - Aggressive: Hostile, threats, all caps ("PAY NOW OR ELSE")
      - Chaotic: Poor grammar, contradictory, disorganized
      - Unknown: Can't determine
      
      attacker_competence:
      - Script_Kiddie: Generic threats, limited technical knowledge
      - Semi_Professional: Some technical detail, partial proof
      - Organized_Group: Sophisticated, detailed victim knowledge, proof provided
      
      attacker_strategy:
      - Competing: Threats, no flexibility ("Pay or else")
      - Compromising: Makes mutual concessions ("We'll go down 30%")
      - Problem_Solving: Seeks win-win ("What can you afford?")
      - Unknown: Can't determine
      
      influence_tactics (list ALL that apply):
      - "Authority" → "We are professionals", "Trust us"
      - "Scarcity" → "Price doubles in 24h", "Deadline"
      - "Reciprocity" → "We already gave discount"
      - "Commitment" → "You already agreed"
      - "Liking" → "I understand your situation"
      - "Social_Proof" → "Other companies paid"
      - Empty array [] if none detected
      
      victim_emotion:
      - Shock_to_Resignation: Initial disbelief → acceptance
      - Anger_to_Compliance: Rage → forced obedience
      - Professional_Detachment: Calm, rational throughout
      - Panic: Repeated fear/pleading
      
      victim_tactic:
      - Poverty_Pleading: Claims financial hardship ("We can't afford")
      - Technical_Stalling: Asks for time ("We need 48h to verify")
      - Relationship_Building: Humanizes situation ("Let's talk")
      - Defiance: Refuses to negotiate ("We'll report to FBI")
      - Rapid_Capitulation: Agrees immediately ("OK, what's the address?")
      
      victim_tactic_effectiveness:
      - High: Gained discount ≥ 20%
      - Medium: Gained time extension or small concession
      - Low: Tactic ignored
      - None: Chat ongoing or no outcome
      
      power_balance:
      - Attacker_Dominant: Attacker sets all terms
      - Victim_Dominant: Victim dictates pace (rare)
      - Balanced: Both negotiate as peers
      
      effectiveness_scores (1-5 scale):
      - 5: Masterful execution, achieved all goals
      - 4: Competent, achieved most goals
      - 3: Neutral, mixed results
      - 2: Weak execution, failed most goals
      - 1: Complete failure
      
      CRITICAL:
      - Output ONLY the JSON object (no extra text)
      - Use exact label names (case-sensitive)
      - influence_tactics is an array (use [] if none)
      - Scores are integers 1-5 only
      
      Chat data:
      {{chat_json}}
