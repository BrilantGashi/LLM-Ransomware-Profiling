tasks:

  speech_act_analysis:
    description: "Classify ransomware chat messages"
    output_format: "json"
    
    system_prompt: |
      Extract structured data from ransomware negotiation logs. Output only valid JSON.
    
    user_template: |
      Classify each message. Output format:
      [{"text":"...","party":"Attacker|Victim","primary_act":"LABEL","argumentative_function":"LABEL","phase":"LABEL"}]
      
      Labels:
      primary_act: INFORMATIVE (facts), DIRECTIVE (commands), COMMISSIVE (threats/promises), NEGOTIATIVE (offers), EXPRESSIVE (emotions)
      argumentative_function: FACTS, PRESSURE, CONDITIONAL, FAIRNESS, TRUST, PROCESS
      phase: OPENING, PROOF, DEMAND, BARGAINING, CLOSURE, OTHER
      
      Data: {{chat_json}}



  tactical_extraction:
    description: "Extract financial/technical indicators"
    output_format: "json"
    
    system_prompt: |
      Extract facts from ransomware logs. Output only valid JSON. Use null for missing data.
    
    user_template: |
      Extract indicators. Output format:
      {
        "initial_demand": int|null,
        "final_price": int|null,
        "currency": "USD|BTC|Unknown",
        "discount_percent": int|null,
        "victim_size": "Enterprise|SME|Unknown",
        "attack_type": "Encryption_Only|Data_Theft_Only|Double_Extortion|Unknown",
        "data_volume_gb": int|null,
        "encryption_confirmed": bool|null,
        "exfiltration_confirmed": bool|null,
        "outcome": "Paid|Not_Paid|Ongoing|Unknown",
        "attacker_flexibility": "High|Medium|Low|Unknown"
      }
      
      Rules:
      - initial_demand: first price attacker states (number only)
      - final_price: agreed price (null if no agreement)
      - discount_percent: ((initial-final)/initial)*100
      - attack_type: Double_Extortion if both encryption AND data theft
      - exfiltration_confirmed: true only if attacker showed proof
      - outcome: Paid if payment confirmed
      - attacker_flexibility: High(>40%), Medium(10-40%), Low(<10%)
      
      Data: {{chat_json}}



  psychological_profiling:
    description: "Analyze communication patterns"
    output_format: "json"
    
    system_prompt: |
      Analyze behavioral patterns in ransomware negotiations. Output only valid JSON.
    
    user_template: |
      Analyze patterns. Output format:
      {
        "attacker_tone": "Professional|Aggressive|Chaotic|Unknown",
        "attacker_competence": "Script_Kiddie|Semi_Professional|Organized_Group|Unknown",
        "attacker_strategy": "Competing|Compromising|Problem_Solving|Unknown",
        "primary_influence_tactic": "Authority|Scarcity|Pressure|Trust|None|Unknown",
        "victim_emotion": "Professional_Detachment|Panic|Resignation|Unknown",
        "victim_tactic": "Poverty_Pleading|Technical_Stalling|Defiance|Rapid_Capitulation|Unknown",
        "power_balance": "Attacker_Dominant|Victim_Dominant|Balanced|Unknown",
        "negotiation_outcome_likelihood": "Low|Medium|High|Unknown"
      }
      
      Quick guide:
      - attacker_tone: Professional(formal), Aggressive(threats), Chaotic(disorganized)
      - attacker_competence: Script_Kiddie(basic), Semi_Professional(some proof), Organized_Group(sophisticated)
      - attacker_strategy: Competing(no flexibility), Compromising(negotiates), Problem_Solving(seeks mutual benefit)
      - primary_influence_tactic: Authority(reputation), Scarcity(deadlines), Pressure(threats), Trust(guarantees)
      - victim_emotion: Professional_Detachment(calm), Panic(desperate), Resignation(compliant)
      - victim_tactic: Poverty_Pleading(can't afford), Technical_Stalling(need time), Defiance(won't pay), Rapid_Capitulation(agrees quickly)
      - power_balance: who controls the negotiation
      - negotiation_outcome_likelihood: Low(refuses), Medium(ongoing), High(agreeing)
      
      Data: {{chat_json}}
