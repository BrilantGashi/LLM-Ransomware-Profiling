# ==============================================================================
# Tactical Extraction - Technical and Financial Indicators
# ==============================================================================

output_format: json

system_prompt: |
  You are a cyber threat intelligence analyst specializing in ransomware operations.
  Extract structured technical and financial indicators from negotiation transcripts.
  Return strict JSON following the exact schema provided.

user_prompt: |
  Task
  Extract structured indicators from this ransomware negotiation.
  Return a SINGLE JSON object (not an array) with the following structure:
  
  {
    "metadata": {
      "victim_size": "Enterprise" | "SME" | "Unknown",
      "attack_type": "Encryption_Only" | "Data_Theft_Only" | "Double_Extortion" | "Unknown"
    },
    "financial_negotiation": {
      "initial_demand": 50000,
      "final_agreed_price": 25000,
      "discount_percentage": 50,
      "currency": "USD" | "BTC" | "Unknown"
    },
    "technical_indicators": {
      "data_volume_gb": 200,
      "exfiltration_confirmed": true
    },
    "negotiation_dynamics": {
      "outcome_status": "Paid" | "Not_Paid" | "Ongoing" | "Unknown",
      "attacker_flexibility": "High" | "Medium" | "Low" | "Unknown"
    }
  }
  
  Extraction Rules
  
  METADATA.victim_size:
  - Enterprise: Large organization, high revenue indicators
  - SME: Small/medium business
  - Unknown: Cannot determine from chat
  
  METADATA.attack_type:
  - Encryption_Only: Files encrypted, no data theft mentioned
  - Data_Theft_Only: Data stolen, no encryption
  - Double_Extortion: Both encryption and data theft
  - Unknown: Cannot determine
  
  FINANCIAL_NEGOTIATION:
  - initial_demand: First price mentioned by attacker (integer or null)
  - final_agreed_price: Final price agreed upon (integer or null)
  - discount_percentage: ((initial - final) / initial) * 100
  - currency: USD (dollars), BTC (bitcoin), or Unknown
  - Use null (not 0) for missing values
  
  TECHNICAL_INDICATORS:
  - data_volume_gb: Amount of data stolen in GB (integer or null)
  - exfiltration_confirmed: true if data theft confirmed, false if not, null if unknown
  
  NEGOTIATION_DYNAMICS.outcome_status:
  - Paid: Evidence of payment in chat
  - Not_Paid: Victim refused or negotiation failed
  - Ongoing: Still negotiating
  - Unknown: Cannot determine
  
  NEGOTIATION_DYNAMICS.attacker_flexibility:
  - High: >40% discount offered
  - Medium: 10-40% discount offered
  - Low: <10% discount or no flexibility
  - Unknown: No financial data available
  
  Important Notes
  - Extract ONLY facts explicitly stated in the chat
  - Use null for missing numeric values (not 0 or -1)
  - Do NOT make assumptions about context not stated
  - If chat is very short, many fields may be null
  
  Chat JSON:
  {{chat_json}}
