# ==============================================================================
# Speech Act Analysis - Ransomware Negotiation Discourse Analysis
# ==============================================================================

output_format: json

system_prompt: |
  You are a careful discourse analyst. Classify each chat message from a ransomware 
  negotiation using a small, theory-grounded set of speech-act categories. 
  Follow the schema exactly and return strict JSON.

user_prompt: |
  Task
  You will label every message in the chat below. The chat is provided as a JSON list 
  of dictionaries, each with fields "party" (either "Victim" or "Attacker") and "content". 
  Messages are in chronological order.
  
  Return a JSON list of dictionaries, one per chat turn, in the same order, using this schema:
  
  {
    "text": "{{verbatim_message}}",
    "party": "Victim|Attacker",
    "primary_act": "INFORMATIVE_DECLARATIVE | DIRECTIVE | COMMISSIVE | NEGOTIATIVE_EVALUATIVE | EXPRESSIVE_METACOMMUNICATIVE",
    "secondary_acts": ["..."],
    "argumentative_function": "GROUNDS/FACTS | ACTION_PRESSURE | CONDITIONAL_REASONING | VALUE/FAIRNESS_APPEAL | FACE/ETHOS_WORK | PROCESS_MAINTENANCE",
    "phase": "OPENING_CONTACT | PROOF_OF_CAPABILITY | DEMAND_FORMULATION | BARGAINING_CONCESSION | RESOLUTION_CLOSURE | OTHER",
    "rationale": "1-3 sentences citing specific words that cue the label."
  }
  
  Labels (theory-grounded)
  
  PRIMARY_SPEECH_ACT (choose exactly one):
  - INFORMATIVE_DECLARATIVE — stating/confirming status or facts; includes "payment received," "data deleted," etc.
  - DIRECTIVE — ordering/requesting/instructing; includes demands and procedural instructions.
  - COMMISSIVE — committing to future action; includes PROMISE, OFFER, and THREAT subtypes.
  - NEGOTIATIVE_EVALUATIVE — proposing/changing terms, counteroffers, and justifications/moral evaluations (fairness, feasibility, proportionality).
  - EXPRESSIVE_METACOMMUNICATIVE — emotion/stance ("sorry," "thanks") and channel/coordination moves ("please confirm," "we will wait").
  
  SECONDARY_SUBTYPES (zero or more; use only when clearly present):
  - For COMMISSIVE: PROMISE | OFFER | THREAT
  - For NEGOTIATIVE_EVALUATIVE: OFFER | COUNTEROFFER | JUSTIFICATION
  - For DIRECTIVE: INSTRUCTION | REQUEST | DEMAND
  - For EXPRESSIVE_METACOMMUNICATIVE: EXPRESSIVE | METACOMMUNICATIVE
  
  ARGUMENTATIVE_FUNCTION (choose one):
  - GROUNDS/FACTS (establishing or updating shared reality)
  - ACTION_PRESSURE (coercing or requesting action)
  - CONDITIONAL_REASONING (if–then threats/promises)
  - VALUE/FAIRNESS_APPEAL (justifying terms; proportionality)
  - FACE/ETHOS_WORK (empathy, politeness, relational maintenance)
  - PROCESS_MAINTENANCE (clarification, confirmation, scheduling)
  
  NEGOTIATION_PHASE (choose one; pick best fit):
  - OPENING_CONTACT | PROOF_OF_CAPABILITY | DEMAND_FORMULATION
  - BARGAINING_CONCESSION | RESOLUTION_CLOSURE | OTHER
  
  Guidance
  - Prefer INFORMATIVE_DECLARATIVE for confirmations/status changes.
  - Label explicit "pay or else" messages as COMMISSIVE with THREAT; argumentative_function = CONDITIONAL_REASONING.
  - Label "we can do X if you pay" as COMMISSIVE (PROMISE or OFFER depending on framing).
  - Label instructions like "send 2-3 files" as DIRECTIVE (INSTRUCTION or DEMAND).
  - Label price moves and moral/feasibility arguments under NEGOTIATIVE_EVALUATIVE with the appropriate subtype.
  - Use EXPRESSIVE_METACOMMUNICATIVE for apologies/thanks and for channel/coordination.
  - If a message clearly contains two forces, choose the most consequential as primary and add the other in secondary_acts.
  
  Chat JSON:
  {{chat_json}}
