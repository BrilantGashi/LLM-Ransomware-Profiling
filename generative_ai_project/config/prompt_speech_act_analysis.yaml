# ==============================================================================
# Speech Act Analysis - Ransomware Negotiation Discourse Analysis
# ==============================================================================

output_format: json

system_prompt: |
  You are a careful discourse analyst. Classify each chat message from a ransomware negotiation using Speech Act Theory and Argumentation Theory. Follow the schema exactly and return strict JSON.

user_prompt: |
  Task
  
  You will label every message in the chat below. The chat is provided as a JSON list of dictionaries, each with fields "party" (either "Attacker" or "Victim") and "message". Messages are in chronological order.
  
  Return a JSON list of dictionaries, one per chat turn, in the same order, using this schema:
  
  {
    "message_id": <number starting from 1>,
    "party": "Attacker|Victim",
    "primary_act": "INFORMATIVE_DECLARATIVE | DIRECTIVE | COMMISSIVE | NEGOTIATIVE_EVALUATIVE | EXPRESSIVE_METACOMMUNICATIVE",
    "secondary_acts": ["..."],
    "argumentative_function": "GROUNDS_FACTS | ACTION_PRESSURE | CONDITIONAL_REASONING | VALUE_FAIRNESS_APPEAL | FACE_ETHOS_WORK | PROCESS_MAINTENANCE",
    "phase": "OPENING_CONTACT | PROOF_OF_CAPABILITY | DEMAND_FORMULATION | BARGAINING_CONCESSION | RESOLUTION_CLOSURE | OTHER"
  }
  
  
  Labels (theory-grounded)
  
  PRIMARY_ACT (choose exactly one):
  
  - INFORMATIVE_DECLARATIVE — stating facts, status updates, declarations about system state or capabilities.
  
  - DIRECTIVE — ordering, requesting, instructing; includes commands, demands, and procedural instructions.
  
  - COMMISSIVE — committing to future action; includes promises, threats, and offers.
  
  - NEGOTIATIVE_EVALUATIVE — proposing terms, counteroffers, price discussions, and evaluations of fairness or feasibility.
  
  - EXPRESSIVE_METACOMMUNICATIVE — expressing emotions, gratitude, or managing communication channel logistics.
  
  
  SECONDARY_ACTS (zero or one; use only when clearly present):
  
  Return an empty array [] if the message has a single clear function. Include ONE string from this list only if dual function clearly exists:
  
  - DIRECTIVE
  - COMMISSIVE  
  - THREAT
  - PROMISE
  - COUNTEROFFER
  
  
  ARGUMENTATIVE_FUNCTION (choose exactly one):
  
  - GROUNDS_FACTS — establishing shared reality, providing factual updates or evidence.
  
  - ACTION_PRESSURE — coercing action through urgency, time pressure, or explicit demands.
  
  - CONDITIONAL_REASONING — presenting if-then logic, conditional threats or promises.
  
  - VALUE_FAIRNESS_APPEAL — justifying terms through fairness, proportionality, or moral reasoning.
  
  - FACE_ETHOS_WORK — building trust, demonstrating credibility, or maintaining relational dynamics.
  
  - PROCESS_MAINTENANCE — clarifying procedures, confirming understanding, or coordinating next steps.
  
  
  PHASE (choose exactly one; pick best fit):
  
  - OPENING_CONTACT — initial greetings, first contact establishment.
  
  - PROOF_OF_CAPABILITY — demonstrating control over systems, showing data samples or evidence.
  
  - DEMAND_FORMULATION — initial statement of ransom demand or requirements.
  
  - BARGAINING_CONCESSION — price negotiation, counteroffers, or discussing payment terms.
  
  - RESOLUTION_CLOSURE — final agreement, payment confirmation, or decryption delivery.
  
  - OTHER — messages not clearly fitting the above phases.
  
  
  Guidance
  
  - Prefer INFORMATIVE_DECLARATIVE for status confirmations and factual statements about system state.
  
  - Label explicit conditional threats ("pay or else") as COMMISSIVE with secondary_acts: ["THREAT"], and use CONDITIONAL_REASONING for argumentative_function.
  
  - Label promises or offers conditioned on payment as COMMISSIVE with appropriate secondary act.
  
  - Use DIRECTIVE for instructions, file upload requests, or explicit demands for action.
  
  - Label price proposals and fairness arguments as NEGOTIATIVE_EVALUATIVE.
  
  - Use EXPRESSIVE_METACOMMUNICATIVE for thanks, apologies, and channel coordination.
  
  - If a message clearly contains two illocutionary forces, choose the most consequential as primary_act and add the secondary function to secondary_acts as a single-element array.
  
  
  Chat JSON:
  {{chat_json}}
